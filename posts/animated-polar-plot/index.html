<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Animated polar plot with oceanographic data &#183; Matplotblog</title><meta name=description content="This post describes how to animate some oceanographic measurements in a tweaked polar plot"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link href=https://matplotlib.org/matplotblog/css/concated.min.css rel=stylesheet><style>body{background:#ecedef url(https://matplotlib.org/matplotblog/bg_tiles.png)repeat}</style></head><body class=single-body><nav class="nav-bar side-padding"><h1 class=nav-header><a href=https://matplotlib.org/matplotblog/ class=nav-text><img src=https://matplotlib.org/matplotblog/mpl_logo.png></a></h1><a href=https://matplotlib.org/matplotblog/index.xml><img src=https://matplotlib.org/matplotblog/rss.svg style=width:25px;margin:10px alt="RSS feed"></a><div class=hamburger-menu><button onclick=hamburgerMenuPressed.call(this) aria-haspopup=true aria-expanded=false aria-controls=menu aria-label=Menu>
<span></span><span></span></button><ul id=menu class=hamburger-menu-overlay><li><a href=https://matplotlib.org/matplotblog/ class=hamburger-menu-overlay-link>Home</a></li><li><a href=https://matplotlib.org/matplotblog/posts/how-to-contribute/ class=hamburger-menu-overlay-link>How to Contribute</a></li><li><a href=https://matplotlib.org/matplotblog/categories/3d class=hamburger-menu-overlay-link>3d</a></li><li><a href=https://matplotlib.org/matplotblog/categories/academia class=hamburger-menu-overlay-link>Academia</a></li><li><a href=https://matplotlib.org/matplotblog/categories/art class=hamburger-menu-overlay-link>Art</a></li><li><a href=https://matplotlib.org/matplotblog/categories/editorial class=hamburger-menu-overlay-link>Editorial</a></li><li><a href=https://matplotlib.org/matplotblog/categories/graphs class=hamburger-menu-overlay-link>Graphs</a></li><li><a href=https://matplotlib.org/matplotblog/categories/gsoc class=hamburger-menu-overlay-link>Gsoc</a></li><li><a href=https://matplotlib.org/matplotblog/categories/industry class=hamburger-menu-overlay-link>Industry</a></li><li><a href=https://matplotlib.org/matplotblog/categories/news class=hamburger-menu-overlay-link>News</a></li><li><a href=https://matplotlib.org/matplotblog/categories/tutorials class=hamburger-menu-overlay-link>Tutorials</a></li><li><a href=https://matplotlib.org class=hamburger-menu-overlay-link target=blank>About</a></li></ul></div></nav><main class="content side-text-padding"><article class="post dropcase"><header class=post-header><h1 class=post-title>Animated polar plot with oceanographic data</h1><p class=post-date>Posted <time datetime=2020-06-12>Jun 12, 2020</time>
<span class=post-author>&mdash; By Kevin Balem</span></p></header><p>The <strong>ocean</strong> is a key component of the Earth climate system. It thus needs a continuous real-time monitoring to help scientists better understand its dynamic and predict its evolution. All around the world, oceanographers have managed to join their efforts and set up a <a href=https://www.goosocean.org>Global Ocean Observing System</a> among which <a href=http://www.argo.ucsd.edu/><strong>Argo</strong></a> is a key component. Argo is a global network of nearly 4000 autonomous probes or floats measuring pressure, temperature and salinity from the surface to 2000m depth every 10 days. The localisation of these floats is nearly random between the 60th parallels (see live coverage <a href=http://collab.umr-lops.fr/app/divaa/>here</a>). All data are collected by satellite in real-time, processed by several data centers and finally merged in a single dataset (collecting more than 2 millions of vertical profiles data) made freely available to anyone.</p><p>In this particular case, we want to plot temperature (surface and 1000m deep) data measured by those floats, for the period 2010-2020 and for the Mediterranean sea. We want this plot to be circular and animated, now you start to get the title of this post: <strong>Animated polar plot</strong>.</p><p>First we need some data to work with. To retrieve our temperature values from Argo, we use <a href=https://argopy.readthedocs.io><strong>Argopy</strong></a>, which is a Python library that aims to ease Argo data access, manipulation and visualization for standard users, as well as Argo experts and operators. Argopy returns <a href=http://xarray.pydata.org>xarray</a> dataset objects, which make our analysis much easier.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> pandas <span style=color:#f92672>as</span> pd
<span style=color:#f92672>import</span> numpy <span style=color:#f92672>as</span> np
<span style=color:#f92672>from</span> argopy <span style=color:#f92672>import</span> DataFetcher <span style=color:#66d9ef>as</span> ArgoDataFetcher
argo_loader <span style=color:#f92672>=</span> ArgoDataFetcher(cache<span style=color:#f92672>=</span>True)
<span style=color:#75715e>#</span>
<span style=color:#75715e># Query surface and 1000m temp in Med sea with argopy</span>
df1 <span style=color:#f92672>=</span> argo_loader<span style=color:#f92672>.</span>region([<span style=color:#f92672>-</span><span style=color:#ae81ff>1.2</span>,<span style=color:#ae81ff>29.</span>,<span style=color:#ae81ff>28.</span>,<span style=color:#ae81ff>46.</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>10.</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>2009-12</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>2020-01</span><span style=color:#e6db74>&#39;</span>])<span style=color:#f92672>.</span>to_xarray()
df2 <span style=color:#f92672>=</span> argo_loader<span style=color:#f92672>.</span>region([<span style=color:#f92672>-</span><span style=color:#ae81ff>1.2</span>,<span style=color:#ae81ff>29.</span>,<span style=color:#ae81ff>28.</span>,<span style=color:#ae81ff>46.</span>,<span style=color:#ae81ff>975.</span>,<span style=color:#ae81ff>1025.</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>2009-12</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>2020-01</span><span style=color:#e6db74>&#39;</span>])<span style=color:#f92672>.</span>to_xarray()
<span style=color:#75715e>#</span>
</code></pre></div><p>Here we create some arrays we'll use for plotting, we set up a date array and extract day of the year and year itself that will be usefull. Then to build our temperature array, we use xarray very usefull methods : <code>where()</code> and <code>mean()</code>. Then we build a pandas Dataframe, because it's prettier!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Weekly date array</span>
daterange<span style=color:#f92672>=</span>np<span style=color:#f92672>.</span>arange(<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>2010-01-01</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>2020-01-03</span><span style=color:#e6db74>&#39;</span>,dtype<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>datetime64[7D]</span><span style=color:#e6db74>&#39;</span>)Â 
dayoftheyear<span style=color:#f92672>=</span>pd<span style=color:#f92672>.</span>DatetimeIndex(np<span style=color:#f92672>.</span>array(daterange,dtype<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>datetime64[D]</span><span style=color:#e6db74>&#39;</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>)<span style=color:#f92672>.</span>dayofyear <span style=color:#75715e># middle of the week</span>
activeyear<span style=color:#f92672>=</span>pd<span style=color:#f92672>.</span>DatetimeIndex(np<span style=color:#f92672>.</span>array(daterange,dtype<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>datetime64[D]</span><span style=color:#e6db74>&#39;</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>)<span style=color:#f92672>.</span>year <span style=color:#75715e># extract year</span>

<span style=color:#75715e># Init final arrays</span>
tsurf<span style=color:#f92672>=</span>np<span style=color:#f92672>.</span>zeros(len(daterange))
t1000<span style=color:#f92672>=</span>np<span style=color:#f92672>.</span>zeros(len(daterange))

<span style=color:#75715e># Filling arrays</span>
<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(daterange)):
    i1<span style=color:#f92672>=</span>(df1[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>TIME</span><span style=color:#e6db74>&#39;</span>]<span style=color:#f92672>&gt;</span><span style=color:#f92672>=</span>daterange[i])<span style=color:#f92672>&amp;</span>(df1[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>TIME</span><span style=color:#e6db74>&#39;</span>]<span style=color:#f92672>&lt;</span>daterange[i]<span style=color:#f92672>+</span><span style=color:#ae81ff>7</span>)    
    i2<span style=color:#f92672>=</span>(df2[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>TIME</span><span style=color:#e6db74>&#39;</span>]<span style=color:#f92672>&gt;</span><span style=color:#f92672>=</span>daterange[i])<span style=color:#f92672>&amp;</span>(df2[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>TIME</span><span style=color:#e6db74>&#39;</span>]<span style=color:#f92672>&lt;</span>daterange[i]<span style=color:#f92672>+</span><span style=color:#ae81ff>7</span>)    
    tsurf[i]<span style=color:#f92672>=</span>df1<span style=color:#f92672>.</span>where(i1,drop<span style=color:#f92672>=</span>True)[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>TEMP</span><span style=color:#e6db74>&#39;</span>]<span style=color:#f92672>.</span>mean()<span style=color:#f92672>.</span>values
    t1000[i]<span style=color:#f92672>=</span>df2<span style=color:#f92672>.</span>where(i2,drop<span style=color:#f92672>=</span>True)[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>TEMP</span><span style=color:#e6db74>&#39;</span>]<span style=color:#f92672>.</span>mean()<span style=color:#f92672>.</span>values

<span style=color:#75715e># Creating dataframe    </span>
d <span style=color:#f92672>=</span> {<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>date</span><span style=color:#e6db74>&#39;</span>: np<span style=color:#f92672>.</span>array(daterange,dtype<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>datetime64[D]</span><span style=color:#e6db74>&#39;</span>), <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>tsurf</span><span style=color:#e6db74>&#39;</span>: tsurf, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>t1000</span><span style=color:#e6db74>&#39;</span>: t1000}
ndf <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(data<span style=color:#f92672>=</span>d)
ndf<span style=color:#f92672>.</span>head()

	date 	tsurf 	t1000
<span style=color:#ae81ff>0</span> 	<span style=color:#ae81ff>2009</span><span style=color:#f92672>-</span><span style=color:#ae81ff>12</span><span style=color:#f92672>-</span><span style=color:#ae81ff>31</span> 	<span style=color:#ae81ff>15.725000</span> 	<span style=color:#ae81ff>13.306133</span>
<span style=color:#ae81ff>1</span> 	<span style=color:#ae81ff>2010</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>07</span> 	<span style=color:#ae81ff>15.530414</span> 	<span style=color:#ae81ff>13.315658</span>
<span style=color:#ae81ff>2</span> 	<span style=color:#ae81ff>2010</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>14</span> 	<span style=color:#ae81ff>15.307378</span> 	<span style=color:#ae81ff>13.300347</span>
<span style=color:#ae81ff>3</span> 	<span style=color:#ae81ff>2010</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span> 	<span style=color:#ae81ff>14.954195</span> 	<span style=color:#ae81ff>13.300647</span>
<span style=color:#ae81ff>4</span> 	<span style=color:#ae81ff>2010</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>28</span> 	<span style=color:#ae81ff>14.708816</span> 	<span style=color:#ae81ff>13.300274</span>
</code></pre></div><p>Then it's time to plot, for that we first need to import what we need, and set some usefull variables.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#f92672>as</span> plt
<span style=color:#f92672>import</span> matplotlib
plt<span style=color:#f92672>.</span>rcParams[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>xtick.major.pad</span><span style=color:#e6db74>&#39;</span>]<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>17</span><span style=color:#e6db74>&#39;</span>
plt<span style=color:#f92672>.</span>rcParams[<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>axes.axisbelow</span><span style=color:#e6db74>&#34;</span>] <span style=color:#f92672>=</span> False
matplotlib<span style=color:#f92672>.</span>rc(<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>axes</span><span style=color:#e6db74>&#39;</span>,edgecolor<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>w</span><span style=color:#e6db74>&#39;</span>)
<span style=color:#f92672>from</span> matplotlib.lines <span style=color:#f92672>import</span> Line2D
<span style=color:#f92672>from</span> matplotlib.animation <span style=color:#f92672>import</span> FuncAnimation
<span style=color:#f92672>from</span> IPython.display <span style=color:#f92672>import</span> HTML

big_angle<span style=color:#f92672>=</span> <span style=color:#ae81ff>360</span><span style=color:#f92672>/</span><span style=color:#ae81ff>12</span>  <span style=color:#75715e># How we split our polar space</span>
date_angle<span style=color:#f92672>=</span>((<span style=color:#ae81ff>360</span><span style=color:#f92672>/</span><span style=color:#ae81ff>365</span>)<span style=color:#f92672>*</span>dayoftheyear)<span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>pi<span style=color:#f92672>/</span><span style=color:#ae81ff>180</span>  <span style=color:#75715e># For a day, a corresponding angle</span>
<span style=color:#75715e># inner and outer ring limit values</span>
inner<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
outer<span style=color:#f92672>=</span><span style=color:#ae81ff>30</span>
<span style=color:#75715e># setting our color values</span>
ocean_color <span style=color:#f92672>=</span> [<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>#ff7f50</span><span style=color:#e6db74>&#34;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>#004752</span><span style=color:#e6db74>&#34;</span>]
</code></pre></div><p>Now we want to make our axes like we want, for that we build a function <code>dress_axes</code> that will be called during the animation process. Here we plot some bars with an offset (combination of <code>bottom</code> and <code>ylim</code> after). Those bars are actually our background, and the offset allows us to plot a legend in the middle of the plot.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>dress_axes</span>(ax):
    ax<span style=color:#f92672>.</span>set_facecolor(<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>w</span><span style=color:#e6db74>&#39;</span>)
    ax<span style=color:#f92672>.</span>set_theta_zero_location(<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>N</span><span style=color:#e6db74>&#34;</span>)
    ax<span style=color:#f92672>.</span>set_theta_direction(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
    <span style=color:#75715e>#Â Here is how we position the months labels</span>
    middles<span style=color:#f92672>=</span>np<span style=color:#f92672>.</span>arange(big_angle<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span> ,<span style=color:#ae81ff>360</span>, big_angle)<span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>pi<span style=color:#f92672>/</span><span style=color:#ae81ff>180</span>
    ax<span style=color:#f92672>.</span>set_xticks(middles)
    ax<span style=color:#f92672>.</span>set_xticklabels([<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>January</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>February</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>March</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>April</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>May</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>June</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>July</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>August</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>September</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>October</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>November</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>December</span><span style=color:#e6db74>&#39;</span>])
    ax<span style=color:#f92672>.</span>set_yticks([<span style=color:#ae81ff>15</span>,<span style=color:#ae81ff>20</span>,<span style=color:#ae81ff>25</span>])
    ax<span style=color:#f92672>.</span>set_yticklabels([<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>15Â°C</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>20Â°C</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>25Â°C</span><span style=color:#e6db74>&#39;</span>])
    <span style=color:#75715e># Changing radial ticks angle</span>
    ax<span style=color:#f92672>.</span>set_rlabel_position(<span style=color:#ae81ff>359</span>)
    ax<span style=color:#f92672>.</span>tick_params(axis<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>both</span><span style=color:#e6db74>&#39;</span>,color<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>w</span><span style=color:#e6db74>&#39;</span>)
    plt<span style=color:#f92672>.</span>grid(None,axis<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>x</span><span style=color:#e6db74>&#39;</span>)
    plt<span style=color:#f92672>.</span>grid(axis<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>y</span><span style=color:#e6db74>&#39;</span>,color<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>w</span><span style=color:#e6db74>&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>:</span><span style=color:#e6db74>&#39;</span>, linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)    
    <span style=color:#75715e># Here is the bar plot that we use as background</span>
    bars <span style=color:#f92672>=</span> ax<span style=color:#f92672>.</span>bar(middles, outer, width<span style=color:#f92672>=</span>big_angle<span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>pi<span style=color:#f92672>/</span><span style=color:#ae81ff>180</span>, bottom<span style=color:#f92672>=</span>inner, color<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>lightgray</span><span style=color:#e6db74>&#39;</span>, edgecolor<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>w</span><span style=color:#e6db74>&#39;</span>,zorder<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
    plt<span style=color:#f92672>.</span>ylim([<span style=color:#ae81ff>2</span>,outer])
    <span style=color:#75715e># Custom legend</span>
    legend_elements <span style=color:#f92672>=</span> [Line2D([<span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>], marker<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>o</span><span style=color:#e6db74>&#39;</span>, color<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>w</span><span style=color:#e6db74>&#39;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>Surface</span><span style=color:#e6db74>&#39;</span>, markerfacecolor<span style=color:#f92672>=</span>ocean_color[<span style=color:#ae81ff>0</span>], markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>),
                       Line2D([<span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>], marker<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>o</span><span style=color:#e6db74>&#39;</span>, color<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>w</span><span style=color:#e6db74>&#39;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>1000m</span><span style=color:#e6db74>&#39;</span>, markerfacecolor<span style=color:#f92672>=</span>ocean_color[<span style=color:#ae81ff>1</span>], markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>),
                       ]
    ax<span style=color:#f92672>.</span>legend(handles<span style=color:#f92672>=</span>legend_elements, loc<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>center</span><span style=color:#e6db74>&#39;</span>, fontsize<span style=color:#f92672>=</span><span style=color:#ae81ff>13</span>, frameon<span style=color:#f92672>=</span>False)
    <span style=color:#75715e># Main title for the figure</span>
    plt<span style=color:#f92672>.</span>suptitle(<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>Mediterranean temperature from Argo profiles</span><span style=color:#e6db74>&#39;</span>,fontsize<span style=color:#f92672>=</span><span style=color:#ae81ff>16</span>,horizontalalignment<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>center</span><span style=color:#e6db74>&#39;</span>)
</code></pre></div><p>From there we can plot the frame of our plot.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>fig <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>))
ax <span style=color:#f92672>=</span> fig<span style=color:#f92672>.</span>add_subplot(<span style=color:#ae81ff>111</span>, polar<span style=color:#f92672>=</span>True)
dress_axes(ax)
plt<span style=color:#f92672>.</span>show()
</code></pre></div><p><img src=axes_empty.png alt=axesFrame></p><p>Then it's finally time to plot our data. Since we want to animated the plot, we'll build a function that will be called in <code>FuncAnimation</code> later on. Since the state of the plot changes on every time stamp, we have to redress the axes for each frame, easy with our <code>dress_axes</code> function. Then we plot our temperature data using basic <code>plot()</code>: thin lines for historical measurements, thicker lines for the current year.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>draw_data</span>(i):       
    <span style=color:#75715e># Clear</span>
    ax<span style=color:#f92672>.</span>cla()
    <span style=color:#75715e># Redressing axes</span>
    dress_axes(ax)
    <span style=color:#75715e># Limit between thin lines and thick line, this is current date minus 51 weeks basically.</span>
    <span style=color:#75715e># why 51 and not 52 ? That create a small gap before the current date, which is prettier</span>
    i0<span style=color:#f92672>=</span>np<span style=color:#f92672>.</span>max([i<span style=color:#f92672>-</span><span style=color:#ae81ff>51</span>,<span style=color:#ae81ff>0</span>])

    ax<span style=color:#f92672>.</span>plot(date_angle[i0:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>], ndf[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>tsurf</span><span style=color:#e6db74>&#39;</span>][i0:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>-</span><span style=color:#e6db74>&#39;</span>,color<span style=color:#f92672>=</span>ocean_color[<span style=color:#ae81ff>0</span>],alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>1.0</span>,linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)     
    ax<span style=color:#f92672>.</span>plot(date_angle[<span style=color:#ae81ff>0</span>:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>], ndf[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>tsurf</span><span style=color:#e6db74>&#39;</span>][<span style=color:#ae81ff>0</span>:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>-</span><span style=color:#e6db74>&#39;</span>,color<span style=color:#f92672>=</span>ocean_color[<span style=color:#ae81ff>0</span>],linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>0.7</span>)     

    ax<span style=color:#f92672>.</span>plot(date_angle[i0:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>], ndf[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>t1000</span><span style=color:#e6db74>&#39;</span>][i0:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>-</span><span style=color:#e6db74>&#39;</span>,color<span style=color:#f92672>=</span>ocean_color[<span style=color:#ae81ff>1</span>],alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>1.0</span>,linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)     
    ax<span style=color:#f92672>.</span>plot(date_angle[<span style=color:#ae81ff>0</span>:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>], ndf[<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>t1000</span><span style=color:#e6db74>&#39;</span>][<span style=color:#ae81ff>0</span>:i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>],<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>-</span><span style=color:#e6db74>&#39;</span>,color<span style=color:#f92672>=</span>ocean_color[<span style=color:#ae81ff>1</span>],linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>0.7</span>)     

    <span style=color:#75715e>#Â Plotting a line to spot the current date easily</span>
    ax<span style=color:#f92672>.</span>plot([date_angle[i],date_angle[i]],[inner,outer],<span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>k-</span><span style=color:#e6db74>&#39;</span>,linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>)
    <span style=color:#75715e># Display the current year as a title, just beneath the suptitle</span>
    plt<span style=color:#f92672>.</span>title(str(activeyear[i]),fontsize<span style=color:#f92672>=</span><span style=color:#ae81ff>16</span>,horizontalalignment<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>center</span><span style=color:#e6db74>&#39;</span>)

<span style=color:#75715e># Test it</span>
draw_data(<span style=color:#ae81ff>322</span>)
plt<span style=color:#f92672>.</span>show()
</code></pre></div><p><img src=thumbnail.png alt=oneplot></p><p>Finally it's time to animate, using <code>FuncAnimation</code>. Then we save it as a mp4 file or we display it in our notebook with <code>HTML(anim.to_html5_video())</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>anim <span style=color:#f92672>=</span> FuncAnimation(fig, draw_data, interval<span style=color:#f92672>=</span><span style=color:#ae81ff>40</span>, frames<span style=color:#f92672>=</span>len(daterange)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, repeat<span style=color:#f92672>=</span>False)    
<span style=color:#75715e>#anim.save(&#39;ArgopyUseCase_MedTempAnimation.mp4&#39;)   </span>
HTML(anim<span style=color:#f92672>.</span>to_html5_video())
</code></pre></div><p><img src=animatedpolar.gif alt=animation></p></article></main><nav class="end-nav side-padding"></nav><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous onload=renderMathInElement(document.body);></script><script src=https://matplotlib.org/matplotblog/js/core.min.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>